# yaml-language-server: $schema=https://app.stainless.com/config.schema.json

# The main edition for the config, see the [docs] for more information.
#
# [docs]: https://www.stainless.com/docs/reference/editions
edition: 2025-10-10

organization:
  name: hypeman
  # Link to your API documentation.
  docs: ''
  # Contact email for bug reports, questions, and support requests.
  contact: ''

# `targets` define the output targets and their customization options, such as
# whether to emit the Node SDK and what its package name should be.
targets:
  go:
    # The edition for this target, see the [docs] for more information.
    #
    # [docs]: https://www.stainless.com/docs/reference/editions
    edition: go.2025-10-08
    package_name: hypeman
    production_repo: onkernel/hypeman-go
    options:
      enable_v2: true
  cli:
    edition: cli.2025-10-08
    binary_name: hypeman
    production_repo: onkernel/hypeman-cli
    options:
      go_sdk_package: github.com/onkernel/hypeman-go
    publish:
      homebrew:
        tap_repo: onkernel/homebrew-tap
        homepage: https://github.com/onkernel/hypeman
        description: orchestrate cloud-hypervisor VMs

# `environments` are a map of the name of the environment (e.g. "sandbox",
# "production") to the corresponding url to use.
environments:
  production: http://localhost:8080

# `resources` define the structure and organization for your API, such as how
# methods and models are grouped together and accessed. See the [configuration
# guide] for more information.
#
# [configuration guide]: https://www.stainless.com/docs/guides/configure#resources
resources:
  health:
    # Configure the methods defined in this resource. Each key in the object is the
    # name of the method and the value is either an endpoint (for example, `get /foo`)
    # or an object with more detail.
    #
    # [reference]: https://www.stainless.com/docs/reference/config#method
    methods:
      check: get /health

  images:
    # Configure the models--named types--defined in the resource. Each key in the
    # object is the name of the model and the value is either the name of a schema in
    # `#/components/schemas` or an object with more detail.
    #
    # [reference]: https://www.stainless.com/docs/reference/config#model
    models:
      image: '#/components/schemas/Image'
    methods:
      list: get /images
      create: post /images
      get: get /images/{name}
      delete: delete /images/{name}

  instances:
    models:
      volume_mount: '#/components/schemas/VolumeMount'
      port_mapping: '#/components/schemas/PortMapping'
      instance: '#/components/schemas/Instance'
    methods:
      list: get /instances
      create: post /instances
      get: get /instances/{id}
      delete: delete /instances/{id}
      standby: post /instances/{id}/standby
      restore: post /instances/{id}/restore
      start: post /instances/{id}/start
      stop: post /instances/{id}/stop
      logs: get /instances/{id}/logs
    # Subresources define resources that are nested within another for more powerful
    # logical groupings, e.g. `cards.payments`.
    subresources:
      volumes:
        methods:
          attach: post /instances/{id}/volumes/{volumeId}
          detach: delete /instances/{id}/volumes/{volumeId}

  volumes:
    models:
      volume: '#/components/schemas/Volume'
      volume_attachment: '#/components/schemas/VolumeAttachment'
    methods:
      list: get /volumes
      create: post /volumes
      get: get /volumes/{id}
      delete: delete /volumes/{id}

  devices:
    models:
      device: '#/components/schemas/Device'
      available_device: '#/components/schemas/AvailableDevice'
      device_type: '#/components/schemas/DeviceType'
    methods:
      list: get /devices
      create: post /devices
      retrieve: get /devices/{id}
      delete: delete /devices/{id}
      list_available: get /devices/available

  ingresses:
    models:
      ingress: '#/components/schemas/Ingress'
      ingress_rule: '#/components/schemas/IngressRule'
      ingress_match: '#/components/schemas/IngressMatch'
      ingress_target: '#/components/schemas/IngressTarget'
    methods:
      list: get /ingresses
      create: post /ingresses
      get: get /ingresses/{id}
      delete: delete /ingresses/{id}

settings:
  # All generated integration tests that hit the prism mock http server are marked
  # as skipped. Removing this setting or setting it to false enables tests, but
  # doing so may result in test failures due to bugs in the test server.
  #
  # [prism mock http server]: https://stoplight.io/open-source/prism
  disable_mock_tests: true
  license: Apache-2.0

# `client_settings` define settings for the API client, such as extra constructor
# arguments (used for authentication), retry behavior, idempotency, etc.
client_settings:
  opts:
    api_key:
      type: string
      nullable: false
      auth:
        security_scheme: bearerAuth
      read_env: HYPEMAN_API_KEY

security:
  - bearerAuth: []

# `readme` is used to configure the code snippets that will be rendered in the
# README.md of various SDKs. In particular, you can change the `headline`
# snippet's endpoint and the arguments to call it with.
readme:
  example_requests:
    default:
      type: request
      endpoint: get /health
      params: {}
    headline:
      type: request
      endpoint: get /health
      params: {}
